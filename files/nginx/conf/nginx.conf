user   nginx nginx;

worker_processes auto;

error_log  /opt/logs/nginx_error.log  crit;

pid        /usr/local/nginx/logs/nginx.pid;

#Specifies the value for maximum file descriptors that can be opened by this process.
worker_rlimit_nofile 65535;

events
	{
		use epoll;
		multi_accept on;
                worker_connections 65535;
	}

http
	{
		include       mime.types;
		default_type  application/octet-stream;

		server_names_hash_bucket_size 128;
		client_header_buffer_size 32k;
		large_client_header_buffers 4 32k;
		client_max_body_size 50m;

		sendfile on;
		tcp_nopush     on;

		keepalive_timeout 10;

		tcp_nodelay on;

		fastcgi_connect_timeout 300;
		fastcgi_send_timeout 300;
		fastcgi_read_timeout 300;
		fastcgi_buffer_size 512k;
		fastcgi_buffers 8 512k;
		fastcgi_busy_buffers_size 1024k;
		fastcgi_temp_file_write_size 512k;

		gzip on;
		gzip_min_length  1k;
		gzip_buffers     4 32k;
		gzip_http_version 1.0;
		gzip_comp_level 2;
		gzip_types       text/plain application/x-javascript text/css application/xml;
		gzip_vary on;
		gzip_proxied        expired no-cache no-store private auth;
		gzip_disable        "MSIE [1-6]\.";

		#limit_zone  crawler  $binary_remote_addr  10m;

		server_tokens off;
		#log format
		log_format  access  '$remote_addr - $remote_user [$time_local] "$request" '
             '$status $body_bytes_sent "$http_referer" '
             '"$http_user_agent" $http_x_forwarded_for';



#server
#          {
#                listen  80 reuseport;
#                server_name  web.cqz.37wan.com;
#                location / {
#                    proxy_set_header Host $http_host;
#                    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#                    proxy_set_header X-Real-Ip $remote_addr;
#                    proxy_set_header X-NginX-Proxy true;
#                    proxy_pass http://127.0.0.1:8080/;
#                    proxy_redirect off;
#                 }
#           }




server
	{
    listen 80;
   # server_name web.cqz.37wan.com;
    root  /www/sf_login/web;
    location / {
           try_files $uri /app_dev.php$is_args$args;
    }
	location ~ ^/(app_dev|config)\.php(/|$) {
        fastcgi_pass unix:/var/run/php/php7-fpm.sock;
        #fastcgi_pass 127.0.0.1:9000;
        fastcgi_split_path_info ^(.+\.php)(/.*)$;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        fastcgi_param DOCUMENT_ROOT $realpath_root;
    }
       location ~ ^/app\.php(/|$) {
        fastcgi_pass unix:/var/run/php/php7-fpm.sock;
        fastcgi_split_path_info ^(.+\.php)(/.*)$;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
       fastcgi_param DOCUMENT_ROOT $realpath_root;
    }

   error_log /var/log/sflog/symfony.error.log;
   access_log  /var/log/sflog/symfony.access.log;
}		
		

		





 server
       {
        listen  80;
        server_name res.cqz.37wan.com;
        root /data/web/cqz;
        index index.html;
        error_page      500 502 503 504 /50x.html;
        location = /50x.html{
                root /data/web/cqz;
        }

        location ~ .*\.(gif|jpg|jpeg|png|bmp|dat|zip|jz|mp3|exe|dds|alpha|rar|spr|dll|pdb|pak|xxx|pck|cur|rs|atf|pwz|flv|lnk|psd|pwb|wav)$
           {
	                root /data/web/cqz;
                        expires      240h;
           }

           location ~ .*\.(js|css|txt|xml|lua|htm|html|cfg|ini|swf|hlsl|fuh|cab|db)$
           {
                        root /data/web/cqz;
			expires        180m;
           }
	   access_log  logs/res.cqz.37wan.com.log  access;

   }


 server
       {
        listen  82;
      #  server_name res.cqz.37wan.com;
        root /data/web/cqz;
        index index.html;
        error_page      500 502 503 504 /50x.html;
        location = /50x.html{
                root /data/web/cqz;
        }

        location ~ .*\.(gif|jpg|jpeg|png|bmp|dat|zip|jz|mp3|exe|dds|alpha|rar|spr|dll|pdb|pak|xxx|pck|cur|rs|atf|pwz|flv|lnk|psd|pwb|wav)$
           {
                        root /data/web/cqz;
                        expires      240h;
           }

           location ~ .*\.(js|css|txt|xml|lua|htm|html|cfg|ini|swf|hlsl|fuh|cab|db)$
           {
                        root /data/web/cqz;
                        expires        180m;
           }
          access_log  logs/res.cqz.37wan.com82.log  access;
   }



server
        {
    listen 8071;
    root /opt/test/sf_login/web;
    location / {
           try_files $uri /app_dev.php$is_args$args;
    }
        location ~ ^/(app_dev|config)\.php(/|$) {
        fastcgi_pass unix:/var/run/php/php7-fpm.sock;
        #fastcgi_pass 127.0.0.1:9000;
        fastcgi_split_path_info ^(.+\.php)(/.*)$;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        fastcgi_param DOCUMENT_ROOT $realpath_root;
    }
       location ~ ^/app\.php(/|$) {
        fastcgi_pass unix:/var/run/php/php7-fpm.sock;
        fastcgi_split_path_info ^(.+\.php)(/.*)$;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
       fastcgi_param DOCUMENT_ROOT $realpath_root;
    }

   error_log /var/log/sflog/test.error.log;
   access_log  /var/log/sflog/test.access.log;
 }


 server
   {
        listen 80;
        server_name res.cqz.zhi-ming.com;
	root /data/web/cqz_qq;
        index index.html;
	error_page      500 502 503 504 /50x.html;

        location = /50x.html
	{
                root /data/web/cqz_qq;
        }

	location ~ .*\.(gif|jpg|jpeg|png|bmp|dat|zip|jz|mp3|exe|dds|alpha|rar|spr|dll|pdb|pak|xxx|pck|cur|rs|atf|pwz|flv|lnk|psd|pwb|wav)$
        {
	root /data/web/cqz_qq;
	expires      240h;
	}
       
   location ~ .*\.(js|css|txt|xml|lua|htm|html|cfg|ini|swf|hlsl|fuh|cab|db)$
           {
	               root /data/web/cqz_qq;
                        expires        180m;
           }

   }



# server {
#        listen       8888;
#        #access_log  logs/host.access.log  main;
#        location / {
#            root   /opt/case/web/zabbix;
#            index  index.html index.htm index.php;
#        }
        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
#        error_page   500 502 503 504  /50x.html;
#        location = /50x.html {
#            root   html;
#        }

        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
        #
#        location ~ \.php$ {
#            root           /opt/case/web/zabbix;
#            fastcgi_pass unix:/var/run/php/php7-fpm.sock;
           # fastcgi_pass   127.0.0.1:9000;
#            fastcgi_index  index.php;
#            fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
#            include        fastcgi.conf;
#        }

       # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        #location ~ /\.ht {
        #    deny  all;
        #}
#    }





include vhost/*.conf;
}




